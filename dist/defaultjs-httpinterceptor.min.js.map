{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/Utils.js","webpack:///(webpack)/buildin/global.js","webpack:///./src/Manager.js","webpack:///./src/XMLHttpRequest.js","webpack:///./src/Fetch.js","webpack:///./src/interceptors/TokenInterceptor.js","webpack:///./src/interceptors/index.js","webpack:///./src/interceptors/OAuthInterceptor.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","GLOBAL","self","window","global","g","this","Function","e","INTERCEPTORS","CACHE","Manager","config","ignoreDocumentOrigin","ignoreOrigins","interceptors","doIntercept","aData","metadata","origin","location","Promise","resolve","data","origins","length","isOriginIgnored","chain","promises","map","interceptor","doAccept","then","undefined","all","filter","getChain","promise","forEach","aInterceptor","doHandle","addInterceptor","arguments","Error","push","reset","XMLHttpRequest","ORGXHR","executeRequest","open","request","method","url","async","username","password","headers","getOwnPropertyNames","aHeader","setRequestHeader","send","body","XHR","xhr","aName","aValue","aMethod","aUrl","isAsync","aUsername","aPassword","URL","protocol","hostname","port","path","pathname","query","search","hash","aBody","console","error","constructor","ORGFETCH","fetch","aRequest","aSetup","setup","token","type","condition","Array","fetchToken","aToken","refreshInterval","refreshToken","setInterval","startRefresh","theAppender","appender","callAppendToken","appendToken","OAuthInterceptor","login","res","json","response","valueSelector","TokenInterceptor","defaultjs","httpinterceptor","VERSION"],"mappings":"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","file":"defaultjs-httpinterceptor.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","const GLOBAL = (() => {\n\tif (typeof self !== 'undefined') { return self; }\n\tif (typeof window !== 'undefined') { return window; }\n\tif (typeof global !== 'undefined') { return global; }\n\treturn {};\n})();\n\nexport {GLOBAL};\nconst Utils = {\n\tGLOBAL : GLOBAL\n};\n\nexport default Utils; ","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import {GLOBAL} from \"./Utils\";\r\n\r\nconst INTERCEPTORS = [];\r\nlet CACHE = {};\r\n\r\nconst getChain = function(aData){\r\n\tconst chain = CACHE[aData.metadata.origin];\r\n\tif(typeof chain !== \"undefined\")\r\n\t\treturn chain;\r\n\t\r\n\tconst promises = INTERCEPTORS.map(interceptor => \r\n\t\tPromise.resolve(interceptor.doAccept(aData))\r\n\t\t.then(value => (value ? interceptor : undefined)));\r\n\t\r\n\tCACHE[aData.metadata.origin] = Promise.all(promises)\r\n\t.then(interceptors => \r\n\t\tinterceptors.filter(interceptor => typeof interceptor !== \"undefined\"));\r\n\t\r\n\treturn CACHE[aData.metadata.origin];\r\n};\r\n\r\nconst isOriginIgnored = function(data, origins){\r\n\tfor(let i = 0; i < origins.length; i++)\r\n\t\tif(data.metadata.origin == origins[i])\r\n\t\t\treturn true;\r\n\t\r\n\treturn false;\r\n};\r\n\r\nconst Manager = {\r\n\tconfig : {\r\n\t\tignoreDocumentOrigin : true,\r\n\t\tignoreOrigins : []\r\n\t},\r\n\tinterceptors : [],\r\n\tdoIntercept : function(aData){\r\n\t\tif(Manager.config.ignoreDocumentOrigin && aData.metadata.origin == GLOBAL.location.origin)\r\n\t\t\treturn Promise.resolve(aData);\r\n\t\tif(typeof Manager.config.ignoreOrigins !== \"undefined\" && isOriginIgnored(aData, Manager.config.ignoreOrigins))\r\n\t\t\treturn Promise.resolve(aData);\r\n\t\t\r\n\t\treturn getChain(aData)\r\n\t\t.then( chain => {\r\n\t\t\tif(typeof chain === \"undefined\" || chain.length == 0)\r\n\t\t\t\treturn Promise.resolve(aData);\r\n\t\t\t\r\n\t\t\tlet promise = Promise.resolve(aData);\r\n\t\t\tchain.forEach(aInterceptor => {\r\n\t\t\t\tpromise = promise.then(aInterceptor.doHandle);\r\n\t\t\t});\r\n\t\t\treturn promise;\r\n\t\t});\r\n\t},\r\n\taddInterceptor : function(aInterceptor){\r\n\t\tif(arguments.length != 1 && typeof aInterceptor !== \"object\")\r\n\t\t\tthrow new Error(\"function required an interceptor\");\r\n\t\tif(typeof aInterceptor.doAccept !== \"function\")\r\n\t\t\tthrow new Error(\"The interceptor required a \\\"doAccept\\\" function!\");\r\n\t\tif(typeof aInterceptor.doHandle !== \"function\")\r\n\t\t\tthrow new Error(\"The interceptor required a \\\"doHandle\\\" function!\");\r\n\t\t\r\n\t\tINTERCEPTORS.push(aInterceptor);\t\t\r\n\t\treturn Manager;\r\n\t},\r\n\treset: ()=>{\r\n\t\tCACHE = {};\r\n\t}\r\n};\r\nexport default Manager; \r\n\r\n\r\n","import Manager from \"./Manager\";\r\nimport {GLOBAL} from \"./Utils\";\r\n\r\nif(typeof GLOBAL.XMLHttpRequest !== \"undefined\"){\r\n\tconst ORGXHR = GLOBAL.XMLHttpRequest;\r\n\tconst executeRequest = function(aData){\r\n\t\tORGXHR.prototype.open.call(this, aData.request.method, aData.url, aData.metadata.async, aData.metadata.username, aData.metadata.password);\r\n\t\tif(typeof aData.request.headers !== \"undefined\")\r\n\t\t\tObject.getOwnPropertyNames(aData.request.headers)\r\n\t\t\t.forEach(aHeader =>{\r\n\t\t\t\tORGXHR.prototype.setRequestHeader.call(this, aHeader, aData.request.headers[aHeader]);\r\n\t\t\t});\r\n\t\tORGXHR.prototype.send.call(this, aData.request.body);\r\n\t}\r\n\tconst XHR = function (){\r\n\t\tconst xhr = new ORGXHR(arguments);\r\n\t\tlet data = undefined;\r\n\t\t\r\n\t\txhr.setRequestHeader = function(aName, aValue){\r\n\t\t\tdata.request.headers = data.request.headers || {};\r\n\t\t\tdata.request.headers[aName] = aValue;\r\n\t\t};\r\n\t\t\r\n\t\txhr.open = function(aMethod, aUrl, isAsync, aUsername, aPassword){\r\n\t\t\tconst url = new URL(aUrl, GLOBAL.location.origin);\r\n\t\t\tdata = {\r\n\t\t\t\turl : aUrl,\r\n\t\t\t\trequest : {\r\n\t\t\t\t\tmethod : aMethod\r\n\t\t\t\t},\r\n\t\t\t\tmetadata : {\r\n\t\t\t\t\tmethod : aMethod,\r\n\t\t\t\t\torigin: url.origin,\r\n\t\t\t\t\tprotocol : url.protocol,\r\n\t\t\t\t\thostname: url.hostname,\r\n\t\t\t\t\tport: url.port,\r\n\t\t\t\t\tpath : url.pathname,\r\n\t\t\t\t\tquery: url.search,\r\n\t\t\t\t\thash : url.hash,\r\n\t\t\t\t\tasync : typeof isAsync === \"boolean\" ? isAsync : true,\r\n\t\t\t\t\tusername : aUsername,\r\n\t\t\t\t\tpassword : aPassword\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t};\r\n\t\t\r\n\t\txhr.send = function(aBody){\r\n\t\t\tif(data.metadata.async){\r\n\t\t\t\tdata.request.body = aBody; \r\n\t    \t\tManager.doIntercept(data)\r\n\t    \t\t.then(executeRequest.bind(xhr))\r\n\t    \t\t[\"catch\"](console.error);\r\n\t\t    }\r\n\t\t\telse\r\n\t\t\t\texecuteRequest.call(xhr, data);\r\n\t\t};\r\n\t\t\r\n\t\treturn xhr;\r\n\t};\r\n\t\r\n\tGLOBAL.XMLHttpRequest = XHR;\r\n\tGLOBAL.XMLHttpRequest.prototype = ORGXHR.prototype;\r\n\tGLOBAL.XMLHttpRequest.prototype.constructor = XHR;\r\n}","import Manager from \"./Manager\";\r\nimport {GLOBAL} from \"./Utils\";\r\n\t\r\nconst ORGFETCH = GLOBAL.fetch;\r\nGLOBAL.fetch = function(aUrl, aRequest){\r\n\tconst url = new URL(aUrl, GLOBAL.location);\r\n\treturn Manager.doIntercept({\r\n\t\t\turl : aUrl,\r\n\t\t\trequest : aRequest || {},\r\n\t\t\tmetadata : {\r\n\t\t\t\tmethod : typeof aRequest === \"undefined\" ? \"GET\" : (aRequest.method || \"GET\"),\r\n\t\t\t\torigin: url.origin,\r\n\t\t\t\tprotocol : url.protocol,\r\n\t\t\t\thostname: url.hostname,\r\n\t\t\t\tport: url.port,\r\n\t\t\t\tpath : url.pathname,\r\n\t\t\t\thash : url.hash,\r\n\t\t\t\tquery: url.search,\r\n\t\t\t\tasync : true\r\n\t\t\t}\r\n\t\t}).then(aData =>ORGFETCH(aData.url, aData.request));\r\n};","/**\r\n * aSetup  =>\r\n * {\r\n * \tcondition : [string | string[] | function(aData}],\r\n * \tfetchToken : function(),\r\n *  appendToken : function(aToken, aData),\r\n *  (optional) refreshInterval,\r\n *  (optional) refreshToken : function()\r\n * }\r\n *\r\n * aData =>\r\n * {\r\n * \turl : String,\r\n * \trequest : {\r\n * \t\tmethod : string,\r\n * \t\t(optional) headers : {\r\n * \t\t\t[header name : string] : [header value : string],\r\n * \t\t\t...\r\n * \t\t},\r\n * \t\t(optional) body : {string | object | FormData | ...]\r\n * \t},\r\n * \tmetadata : {\r\n * \t\tmethod : string,\r\n * \t\torigin : string,\r\n * \t\thostname : string,\r\n * \t\tprotocol : string,\r\n * \t\t(optional) port : number,\r\n * \t\tquery : string,\r\n * \t}\r\n * }\r\n */\r\nconst TokenInterceptor = function (aSetup) {\r\n\tconst setup = aSetup;\r\n\tlet token = undefined;\r\n\r\n\tconst callAppendToken = function (aToken, aData, theAppender) {\r\n\t\tif (theAppender instanceof Array) {\r\n\t\t\tlet promise = Promise.resolve(aData);\r\n\t\t\ttheAppender.forEach((appender) => {\r\n\t\t\t\tpromise = promise.then((aData) => appender(aToken, aData));\r\n\t\t\t});\r\n\t\t\treturn promise;\r\n\t\t} else return Promise.resolve(theAppender(aToken, aData));\r\n\t};\r\n\r\n\tconst startRefresh = function () {\r\n\t\tif (setup.refreshInterval > 0) {\r\n\t\t\tconst refreshToken =\r\n\t\t\t\ttypeof setup.refreshToken === \"function\"\r\n\t\t\t\t\t? function () {\r\n\t\t\t\t\t\t\ttoken = Promise.resolve(setup.refreshToken());\r\n\t\t\t\t\t  }\r\n\t\t\t\t\t: function () {\r\n\t\t\t\t\t\t\ttoken = Promise.resolve(setup.fetchToken());\r\n\t\t\t\t\t  };\r\n\r\n\t\t\tsetInterval(refreshToken, setup.refreshInterval || 60 * 1000);\r\n\t\t}\r\n\t};\r\n\r\n\treturn {\r\n\t\tdoAccept:\r\n\t\t\tsetup.doAccept ||\r\n\t\t\tfunction (aData) {\r\n\t\t\t\tconst type = typeof setup.condition;\r\n\t\t\t\tif (type === \"function\") return Promise.resolve(setup.condition(aData));\r\n\t\t\t\telse if (type === \"string\") return Promise.resolve(setup.condition == aData.metadata.origin);\r\n\t\t\t\telse if (setup.condition instanceof Array) {\r\n\t\t\t\t\tfor (let i = 0; i < setup.condition.length; i++) if (setup.condition[i] == aData.metadata.origin) return Promise.resolve(true);\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.resolve(false);\r\n\t\t\t},\r\n\t\tdoHandle: function (aData) {\r\n\t\t\tif (!token){\r\n\t\t\t\tconst {url, metadata} = aData;\r\n\t\t\t\ttoken = Promise.resolve(setup.fetchToken({url, metadata})).then((aToken) => {\r\n\t\t\t\t\tstartRefresh();\r\n\t\t\t\t\treturn aToken;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn token.then((aToken) => callAppendToken(aToken, aData, setup.appendToken));\r\n\t\t},\r\n\t};\r\n};\r\n\r\nexport default TokenInterceptor;\r\n","import OAuthInterceptor from \"./OAuthInterceptor\";\r\nimport TokenInterceptor from \"./TokenInterceptor\";\r\n\r\n\r\nconst Data = {\r\n\tOAuthInterceptor : OAuthInterceptor,\r\n\tTokenInterceptor : TokenInterceptor\r\n};\r\n\r\nexport default Data;","import TokenInterceptor from \"./TokenInterceptor\"\r\n\r\nconst OAuthInterceptor = function(aSetup){\r\n\tconst setup = aSetup;\r\n\tsetup.fetchToken = function(){\r\n\t\treturn fetch(setup.login.url, {\r\n\t\t\tmethod: (setup.login.method || \"get\")\r\n\t\t}).then(res => res.json())\r\n\t\t.then(res => res[setup.login.response.valueSelector]);\t\t\r\n\t};\r\n\tsetup.appendToken = function(aToken, aData){\r\n\t\taData.request.headers = aData.request.headers || {};\r\n\t\taData.request.headers[\"Authorization\"] = \"Bearer \" + aToken;\r\n\t\treturn aData;\r\n\t};\r\n\treturn TokenInterceptor(aSetup);\r\n};\r\n\r\nexport default OAuthInterceptor;\r\n","import {GLOBAL} from \"./Utils\";\r\nimport \"./XMLHttpRequest\";\r\nimport \"./Fetch\";\r\nimport Manager from \"./Manager\";\r\nimport Interceptors from \"./interceptors\";\r\n\r\nGLOBAL.defaultjs = GLOBAL.defaultjs || {};\r\nGLOBAL.defaultjs.httpinterceptor = GLOBAL.defaultjs.httpinterceptor || {\r\n\tVERSION : \"${version}\",\r\n\tManager : Manager,\r\n\tinterceptors : Interceptors\r\n};"],"sourceRoot":""}