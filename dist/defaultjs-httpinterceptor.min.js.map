{"version":3,"file":"defaultjs-httpinterceptor.min.js","mappings":"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","sources":["webpack://@default-js/defaultjs-httpinterceptor/webpack/bootstrap","webpack://@default-js/defaultjs-httpinterceptor/webpack/runtime/global","webpack://@default-js/defaultjs-httpinterceptor/./src/Utils.js","webpack://@default-js/defaultjs-httpinterceptor/./src/Constants.js","webpack://@default-js/defaultjs-httpinterceptor/./src/Manager.js","webpack://@default-js/defaultjs-httpinterceptor/./src/XMLHttpRequest.js","webpack://@default-js/defaultjs-httpinterceptor/./src/Fetch.js","webpack://@default-js/defaultjs-httpinterceptor/./src/interceptors/Interceptor.js","webpack://@default-js/defaultjs-httpinterceptor/./src/interceptors/TokenInterceptor.js","webpack://@default-js/defaultjs-httpinterceptor/./src/interceptors/OAuthInterceptor.js","webpack://@default-js/defaultjs-httpinterceptor/./src/interceptors/index.js","webpack://@default-js/defaultjs-httpinterceptor/./src/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","const GLOBAL = (() => {\n\tif (typeof self !== 'undefined') { return self; }\n\tif (typeof window !== 'undefined') { return window; }\n\tif (typeof global !== 'undefined') { return global; }\n\treturn {};\n})();\n\nexport {GLOBAL};\nconst Utils = {\n\tGLOBAL : GLOBAL\n};\n\nexport default Utils; ","import {GLOBAL} from \"./Utils\";\r\nexport const ORGFETCH = GLOBAL.fetch;","import { GLOBAL } from \"./Utils\";\r\nimport {ORGFETCH} from \"./Constants\";\r\nconst CURRENTORIGIN = GLOBAL.location.origin;\r\n\r\nclass Manager {\r\n\t#cache = {};\r\n\t#ignoredUrls = {};\r\n\t#ignoredOrigins = {};\r\n\t#ignoreDocumentOrigin = false;\r\n\t#interceptors = [];\r\n\r\n\tconstructor() { }\r\n\r\n\tignoreDocumentOrigin(value) {\r\n\t\tthis.#ignoreDocumentOrigin = value;\r\n\t}\r\n\r\n\taddOriginToIgnore(origins) {\r\n\t\tif (origins instanceof Array)\r\n\t\t\tfor (let origin of origins)\r\n\t\t\t\tthis.#ignoredOrigins[origins] = true;\r\n\t\telse\r\n\t\t\tthis.#ignoredOrigins[origins] = true;\r\n\t}\r\n\r\n\taddUrlToIgnore(urls) {\r\n\t\tif (urls instanceof Array)\r\n\t\t\tfor (let url of urls)\r\n\t\t\t\tthis.#ignoredUrls[url] = true;\r\n\t\telse\r\n\t\t\tthis.#ignoredUrls[urls] = true;\r\n\t}\r\n\r\n\taddInterceptor(aInterceptor) {\r\n\t\tif (typeof aInterceptor !== \"object\")\r\n\t\t\tthrow new Error(\"function required an interceptor\");\r\n\t\tif (typeof aInterceptor.doAccept !== \"function\")\r\n\t\t\tthrow new Error(\"The interceptor required a \\\"doAccept\\\" function!\");\r\n\t\tif (typeof aInterceptor.doHandle !== \"function\")\r\n\t\t\tthrow new Error(\"The interceptor required a \\\"doHandle\\\" function!\");\r\n\r\n\t\tthis.#interceptors.push(aInterceptor);\r\n\t\tthis.reset();\r\n\t}\r\n\r\n\tasync doIntercept(aData) {\r\n\t\tconst origin = aData.metadata.origin;\r\n\r\n\t\tif (this.#isIgnored(origin, aData.url.toString()))\r\n\t\t\treturn aData;\r\n\r\n\t\tconst {url, metadata} = aData;\r\n\t\tconst chain = await this.#getChain(origin, {url, metadata});\r\n\t\tif (!chain)\r\n\t\t\treturn aData;\r\n\r\n\t\tfor (let interceptor of chain)\r\n\t\t\taData = await interceptor.doHandle(aData);\r\n\r\n\t\treturn aData;\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.#cache = {};\r\n\t}\r\n\r\n\tasync uncheckedFetch(url, request){\r\n\t\treturn ORGFETCH(url, request);\r\n\t}\r\n\r\n\t#isIgnored (origin, url) {\r\n\t\tif (this.#ignoredUrls[url])\r\n\t\t\treturn true\t\r\n\t\tif (this.#ignoreDocumentOrigin && origin == CURRENTORIGIN)\r\n\t\t\treturn true;\r\n\t\tif(this.#ignoredOrigins[origin])\r\n\t\t\treturn true;\r\n\r\n\t\treturn false\r\n\t}\r\n\r\n\tasync #getChain (origin, data){\r\n\t\tlet chain = this.#cache[origin];\r\n\t\tif (!chain) {\r\n\t\t\tchain = this.#interceptorForOrigin(origin, data);\r\n\t\t\tthis.#cache[origin] = chain;\r\n\t\t}\r\n\t\r\n\t\treturn chain;\r\n\t}\r\n\t\r\n\tasync #interceptorForOrigin(origin, data){\r\n\t\tconst result = [];\r\n\t\tfor (let interceptor of this.#interceptors) {\r\n\t\t\tif (await interceptor.doAccept(data))\r\n\t\t\t\tresult.push(interceptor)\r\n\t\t}\r\n\t\r\n\t\treturn result;\r\n\t}\r\n};\r\n\r\nconst INSTANCE = new Manager();\r\n\r\n\r\nexport default INSTANCE;\r\n\r\n\r\n","import Manager from \"./Manager\";\r\nimport {GLOBAL} from \"./Utils\";\r\n\r\nif(typeof GLOBAL.XMLHttpRequest !== \"undefined\"){\r\n\tconst ORGXHR = GLOBAL.XMLHttpRequest;\r\n\tconst executeRequest = function(aData){\r\n\t\tORGXHR.prototype.open.call(this, aData.request.method, aData.url, aData.metadata.async, aData.metadata.username, aData.metadata.password);\r\n\t\tif(typeof aData.request.headers !== \"undefined\")\r\n\t\t\tObject.getOwnPropertyNames(aData.request.headers)\r\n\t\t\t.forEach(aHeader =>{\r\n\t\t\t\tORGXHR.prototype.setRequestHeader.call(this, aHeader, aData.request.headers[aHeader]);\r\n\t\t\t});\r\n\t\tORGXHR.prototype.send.call(this, aData.request.body);\r\n\t}\r\n\tconst XHR = function (){\r\n\t\tconst xhr = new ORGXHR(arguments);\r\n\t\tlet data = undefined;\r\n\t\t\r\n\t\txhr.setRequestHeader = function(aName, aValue){\r\n\t\t\tdata.request.headers = data.request.headers || {};\r\n\t\t\tdata.request.headers[aName] = aValue;\r\n\t\t};\r\n\t\t\r\n\t\txhr.open = function(aMethod, aUrl, isAsync, aUsername, aPassword){\r\n\t\t\tconst url = new URL(aUrl, GLOBAL.location.origin);\r\n\t\t\tdata = {\r\n\t\t\t\turl : aUrl,\r\n\t\t\t\trequest : {\r\n\t\t\t\t\tmethod : aMethod\r\n\t\t\t\t},\r\n\t\t\t\tmetadata : {\r\n\t\t\t\t\tmethod : aMethod,\r\n\t\t\t\t\torigin: url.origin,\r\n\t\t\t\t\tprotocol : url.protocol,\r\n\t\t\t\t\thostname: url.hostname,\r\n\t\t\t\t\tport: url.port,\r\n\t\t\t\t\tpath : url.pathname,\r\n\t\t\t\t\tquery: url.search,\r\n\t\t\t\t\thash : url.hash,\r\n\t\t\t\t\tasync : typeof isAsync === \"boolean\" ? isAsync : true,\r\n\t\t\t\t\tusername : aUsername,\r\n\t\t\t\t\tpassword : aPassword\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t};\r\n\t\t\r\n\t\txhr.send = function(aBody){\r\n\t\t\tif(data.metadata.async){\r\n\t\t\t\tdata.request.body = aBody; \r\n\t    \t\tManager.doIntercept(data)\r\n\t    \t\t.then(executeRequest.bind(xhr))\r\n\t    \t\t[\"catch\"](console.error);\r\n\t\t    }\r\n\t\t\telse\r\n\t\t\t\texecuteRequest.call(xhr, data);\r\n\t\t};\r\n\t\t\r\n\t\treturn xhr;\r\n\t};\r\n\t\r\n\tGLOBAL.XMLHttpRequest = XHR;\r\n\tGLOBAL.XMLHttpRequest.prototype = ORGXHR.prototype;\r\n\tGLOBAL.XMLHttpRequest.prototype.constructor = XHR;\r\n}","import Manager from \"./Manager\";\r\nimport {GLOBAL} from \"./Utils\";\r\nimport {ORGFETCH} from \"./Constants\";\r\n\t\r\nGLOBAL.fetch = async function(aUrl, aRequest){\r\n\tconst url = new URL(aUrl, GLOBAL.location);\r\n\tconst data = await Manager.doIntercept({\r\n\t\t\turl : aUrl,\r\n\t\t\trequest : aRequest || {},\r\n\t\t\tmetadata : {\r\n\t\t\t\tmethod : typeof aRequest === \"undefined\" ? \"GET\" : (aRequest.method || \"GET\"),\r\n\t\t\t\torigin: url.origin,\r\n\t\t\t\tprotocol : url.protocol,\r\n\t\t\t\thostname: url.hostname,\r\n\t\t\t\tport: url.port,\r\n\t\t\t\tpath : url.pathname,\r\n\t\t\t\thash : url.hash,\r\n\t\t\t\tquery: url.search,\r\n\t\t\t\tasync : true\r\n\t\t\t}\r\n\t\t});\r\n\t\t\t\r\n\treturn ORGFETCH(data.url, data.request);\r\n};","import {ORGFETCH} from \"../Constants\";\r\n\r\nexport default class Interceptor{\r\n    async doAccept(data){}\r\n    async doHandle(data){}\r\n    async unceckedFetch(url, request){\r\n\t\treturn ORGFETCH(url, request);\r\n\t}\r\n\r\n};","/**\r\n * aSetup  =>\r\n * {\r\n * \tcondition : [string | string[] | function(aData}],\r\n * \tfetchToken : function(),\r\n *  appendToken : function(aToken, aData),\r\n *  (optional) refreshInterval,\r\n *  (optional) refreshToken : function()\r\n * }\r\n *\r\n * aData =>\r\n * {\r\n * \turl : String,\r\n * \trequest : {\r\n * \t\tmethod : string,\r\n * \t\t(optional) headers : {\r\n * \t\t\t[header name : string] : [header value : string],\r\n * \t\t\t...\r\n * \t\t},\r\n * \t\t(optional) body : {string | object | FormData | ...]\r\n * \t},\r\n * \tmetadata : {\r\n * \t\tmethod : string,\r\n * \t\torigin : string,\r\n * \t\thostname : string,\r\n * \t\tprotocol : string,\r\n * \t\t(optional) port : number,\r\n * \t\tquery : string,\r\n * \t}\r\n * }\r\n */\r\n\r\nimport Interceptor from \"./Interceptor\";\r\nexport default class TokenInterceptor extends Interceptor {\r\n\r\n\t#token = null;\r\n\t#lastData = {};\r\n\t#condition;\r\n\t#fetchToken;\r\n\t#appendToken;\r\n\t#refreshInterval;\r\n\t#refreshToken;\r\n\r\n\tconstructor({ condition, fetchToken, appendToken, refreshInterval = 60 * 1000, refreshToken }) {\r\n\t\tsuper();\r\n\t\tif(typeof condition !== \"string\" && !(condition instanceof Array) && typeof condition !== \"function\")\r\n\t\t\tthrow new Error(`Parameter \"condition\" must be a \"string\", \"array\" or \"function\"!`);\r\n\t\tthis.#condition = condition;\r\n\t\t\r\n\t\tif(typeof fetchToken !== \"function\")\r\n\t\t\tthrow new Error(`Parameter \"fetchToken\" must be a \"function\"!`);\r\n\t\tthis.#fetchToken = fetchToken;\r\n\r\n\t\tif(typeof appendToken !== \"function\")\r\n\t\t\tthrow new Error(`Parameter \"appendToken\" must be a \"function\"!`);\r\n\t\tthis.#appendToken = appendToken;\r\n\r\n\t\tthis.#refreshInterval = refreshInterval;\r\n\t\tthis.#refreshToken = refreshToken;\r\n\t}\r\n\r\n\tasync doAccept(data) {\r\n\t\tconst type = typeof this.#condition;\r\n\t\tconst condition = this.#condition;\r\n\t\tconst origin = data.metadata.origin;\r\n\t\tif (type === \"function\") return await condition(data);\r\n\t\telse if (type === \"string\") return condition == origin;\r\n\t\telse if (condition instanceof Array)\r\n\t\t\treturn condition.includes(origin);\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tasync doHandle(data) {\r\n\t\tif (!this.#token) {\r\n\t\t\tconst { url, metadata } = data;\r\n\t\t\tthis.#lastData = { url, metadata };\r\n\t\t\tthis.#token = this.#fetchToken({ url, metadata });\r\n\t\t\tthis.#startRefresh();\r\n\t\t}\r\n\r\n\t\treturn this.#callAppendToken(data);\r\n\t}\r\n\r\n\tasync #callAppendToken(data) {\r\n\t\tconst appender = this.#appendToken;\r\n\t\tconst token = await this.#token;\r\n\t\tconst result = await appender(token, data);\r\n\r\n\t\treturn result ? result : data;\r\n\t}\r\n\r\n\t#startRefresh() {\r\n\t\tif (this.#refreshInterval > 0) {\r\n\t\t\tconst refreshToken = this.#refreshToken || (() => this.#fetchToken(this.#lastData));\r\n\t\t\tsetInterval(() => {\r\n\t\t\t\tif (this.#refreshToken)\r\n\t\t\t\t\tthis.#refreshToken(this.#lastData);\r\n\t\t\t\telse\r\n\t\t\t\t\tthis.#fetchToken(this.#lastData);\r\n\t\t\t}, this.#refreshInterval);\r\n\t\t}\r\n\t}\r\n};","import TokenInterceptor from \"./TokenInterceptor\"\r\n\r\nconst OAuthInterceptor = function(aSetup){\r\n\tconst setup = aSetup;\r\n\tsetup.fetchToken = async () => {\r\n\t\tconst response = await fetch(setup.login.url, {\r\n\t\t\tmethod: (setup.login.method || \"get\")\r\n\t\t});\r\n\t\tresponse = await response.json();\r\n\t\treturn response[setup.login.response.valueSelector];\r\n\t};\r\n\tsetup.appendToken = function(aToken, aData){\r\n\t\taData.request.headers = aData.request.headers || {};\r\n\t\taData.request.headers[\"Authorization\"] = \"Bearer \" + aToken;\r\n\t\treturn aData;\r\n\t};\r\n\treturn TokenInterceptor(aSetup);\r\n};\r\n\r\nexport default OAuthInterceptor;\r\n","import Interceptor from \"./Interceptor\";\r\nimport OAuthInterceptor from \"./OAuthInterceptor\";\r\nimport TokenInterceptor from \"./TokenInterceptor\";\r\n\r\n\r\nexport default  {\r\n\tInterceptor,\r\n\tOAuthInterceptor,\r\n\tTokenInterceptor\r\n};","import {GLOBAL} from \"./Utils\";\r\nimport \"./XMLHttpRequest\";\r\nimport \"./Fetch\";\r\nimport Manager from \"./Manager\";\r\nimport interceptors from \"./interceptors\";\r\n\r\nGLOBAL.defaultjs = GLOBAL.defaultjs || {};\r\nGLOBAL.defaultjs.httpinterceptor = GLOBAL.defaultjs.httpinterceptor || {\r\n\tVERSION : \"${version}\",\r\n\tManager,\r\n\tinterceptors\r\n};"],"names":["__webpack_require__","g","globalThis","this","Function","e","window","GLOBAL","self","ORGFETCH","fetch","CURRENTORIGIN","location","origin","constructor","ignoreDocumentOrigin","value","addOriginToIgnore","origins","Array","addUrlToIgnore","urls","url","addInterceptor","aInterceptor","Error","doAccept","doHandle","push","reset","async","aData","metadata","toString","chain","interceptor","request","data","result","XMLHttpRequest","ORGXHR","executeRequest","prototype","open","call","method","username","password","headers","Object","getOwnPropertyNames","forEach","aHeader","setRequestHeader","send","body","XHR","xhr","arguments","aName","aValue","aMethod","aUrl","isAsync","aUsername","aPassword","URL","protocol","hostname","port","path","pathname","query","search","hash","aBody","then","bind","console","error","aRequest","Interceptor","TokenInterceptor","condition","fetchToken","appendToken","refreshInterval","refreshToken","super","type","includes","appender","token","setInterval","OAuthInterceptor","aSetup","setup","response","login","json","valueSelector","aToken","defaultjs","httpinterceptor","VERSION","Manager","interceptors"],"sourceRoot":""}